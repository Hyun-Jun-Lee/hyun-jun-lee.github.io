---
title: "네트워크 장비" #Article title.
date: 2023-09-01
category: [NETWORK, NETWORK] #One, more categories or no at all.
tag: [network]
---

# 네트워크 장비

## 허브

멀티탭 같이 하나의 네트워크 회선을 여러 개의 단말장치가 연결될 수 있도록 단말 수만큼 포트 수를 늘려 분배해주는 장비, 보통 허브 뒤편에 보면 여러 개의 LAN 포트가 있고 이 LAN 포트에 케이블을 연결해 여러 대의 컴퓨터를 네트워크에 연결할 수 있다.

허브에에 4개의 단말 장치 a,b,c,d 가 있다고 할 때

a에서 c로 데이터를 보내면 허브에서 데이터를 전달 받고 연결된 모든 단말장치에 데이터를 보낸다. 데이터에는 출발지인 a의 mac 주소와 도착지 c의 mac주속 포함되어 있어서 단말장치 b,d는 mac 주소 정보가 자신들과 일치하지 않기 때문에 데이터를 무시한다.

즉, 하나의 데이터를 정확한 목적지까지 한 번에 보내는 것이 아니라 연결된 모든 장치에 보낸 다음 데이터 수신지에서 자신이 목적지인지 아닌지를 MAC주소를 보고 판단하는 방식이다.
이런 허브의 작동 방식 때문에 데이터를 허브에 연결된 단말장치에 보내는 과정에서 동시에 다른 단말장치가 데이터를 보낼 경우 데이터 충돌이 발생한다. 그리고 이런 충돌이 발생하는 영역을 Collision Domain이라고 한다.

그래서 같은 허브에 연결되어 있고 충돌 영역에 있는 단말장치들은 특정 단말장치가 통신하는 동안에는 기다려야 하기 때문에 네트워크 성능 저하의 원인이 될 수도 있다.

### 허브의 단점

대역폭은 전송 채널을 통해 초당 전송되는 데이터의 양을 뜻하고 '전송 대역폭' 이라는 것은 일정 시간동안 해당 전송 채널을 통해 얼마나 많은 데이터가 전송되었는지를 나타내고 이것은 네트워크의 전송 속도를 의미한다.

허브에게로 온 데이터 A,B,C는 각각 단말장치 a,b,c로 가야하는 상황 일 때, 허브는 한번에 데이터 A,B,C를 단말장치 a,b,c로 보낼 수 없기 때문에 데이터 A를 모든 단말장치로 보내고 그 다음에 B,C를 보내야 한다. 

즉, 단말장치 a로 전송되어야하는 전체 데이터 A의 양이 1이라면, 한 번에 받을 수 있는 데이터의 양은 1이 아닌 1/3 인것이다.

전송대역폭이 3 Mbps인 인터넷 회선이 허브에 연결되어 있다고 할 때, 허브 내부의 데이터 흐름을 보면 허브 장비는 데이터를 한 번에 하나 씩 단말장치에 전송해야하기 때문에 각 단말장치의 전송 대역폭은 1/3만큼 줄어든 1Mbps가 된다.

현실에서 3차선 도로가 1차선 도로로 좁아지는 느낌


이렇게 허브는 네트워크 회선에서 지원하는 대역폭을 충분히 보장하지 못하고 연결되는 단말장치가 많을수록 데이터 충돌도 증가하기 때문에 전반적인 네트워크 성능이 떨어져서 요즘엔 사용하지 않는다.


## 스위치

허브의 네트워크 분배 과정에서 발생하는 데이터의 충돌 영역을 줄이고, 네트워크의 전송 대역폭을 보장하기 위해 개발된 네트워크 장비가 스위치이다. 허브와 같이 포트네 여러개의 LAN을 연결하지만, 네트워크 전송 방식이 허브와 다르고 데이터 전송 이외에도 추가적인 네트워크 기능을 제공한다.

우리가 운전할 떄 도로 안내표지판을 보고 경로를 결정하듯, 네트워크에서 데이터는 스위치 장비에 잇는 MAC Address Table 을 참조하여 목적지 까지 경로를 정한다. MAC Address Table은 MAC 주소를 기준으로 단말장치가 스위치의 어느 포트를 통해 나가야 할지 정의한 표다.

스위치1에 단말장치 a,b,c,d가 연결 되어있고 a가c로 데이터를 보낼 경우 데이터는 제일 먼저 스위치로 전송된다. 여기서 스위치는 데이터에 포함된 목적이 MAC 주소 정보를 자신이 가지고 있는 MAC 주소 테이블과 비교해서 목적지 MAC 주소와 일치하는 단말장치 C로 스위치의 x번 포트를 통해 데이터를 전달한다. 이렇게 스위치는 MAC주소 테이블을 통해 한 번에 경로를 결정해서 허브가 가지고 있던 충돌 영역 문제를 줄일 수 있다.

### 스위치의 MAC Address Table Update

스위치는 자신을 통해 오가는 데이터에 포함된 MAc 주소 정보로 MAC Address Table 을 갱신하여 이를 활용하고 이 과정에서 MAC 주소를 알아내기 위해 ARP(Address Resoltion Protocol)이 사용된다.

ARP는 네트워크에서 IP 주소에 대응되는 MAC 주소를 결정한느 규악으로 ,데이터를 보내고자 하는 목적지 IP 주소를 가지고 MAC 주소를 알아내는 방법이다.

그리고 스위치가 자신의 MAC Address Table을 가지고 단말 장치 간 데이터를 중계하는 일련의 과정을 쉬이칭 이라고 한다.

### 허브 vs 스위치 비교

허브는 모든 단말장치로 데이터를 보내 단말장치 스스로가 수신한 데이터의 MAC 주소와 단말장치 자신의 MAC 주소를 비교해서 수신여부를 결정하고

스위치는 단말장치가 아닌 스위치가 MAC 주소 테이블을 통해 경로를 결정하고 목적지에 맞는 단말장치에만 데이터를 전달한다.

이런 스위치의 통신 방식은 데이터의 충돌 영역 문제를 크게 줄일 수 있고, 스위치에 연결된 단말장치들이 서로 영향을 주지 않기 때문에 스위치에 연결된 네트워크 회선의 전송 대역폭이 보장된다.

## 라우터

서로 다른 서브넷을 가진 네트워크끼리 통신을 하고자 할 때, 두 개의 네트워크 사이에 네트워크 장비를 하나 더 두고 오가는 데이터를 중계하면 되는데 이 장비를 Router 라고한다.

스위치에서는 MAC Address Table과 같이 라우터에는 Routing Table이 있다.

라우팅 테이블에는 라우터와 연결된 네트워크 주소별로 데이터를 내보내기 위한 출력 인터페이스가 정의되어 있다. 해당 네트워크의 목적지 주소별 출력 인터페이스 정보를 가지고 라우터는 데이터 목적지 IP주소의 네트워크 주소에 해당 되는 인터페이스로 데이터를 포워딩한다.

예를들어 네트워크 주소가 '10.1.1.1/24' 인 네트워크 A에서 목적지 IP 주소 '10.3.3.3/24' 로 지정된 데이터가 라우터로 전달이 되었다.

데이터를 받은 라우터는 제일 먼저 데이터에서 지정된 목적지 IP 주소를, 각 라우팅 테이블의 서브넷 마스크 주소와 AND 연산을 해서 네트워크 주소값이 일치하는 네트워크를 찾는다.

### 라우터의 경로 설정 방법

라우터 장비도 한번에 처리할 수 있는 데이터 양에 한계가 있기 때문에 다른 라우터 장비들과 연결되어 데이터를 중계하고 이 과정에서 Route라는 개념이 생겨났다.

서로 연결되는 라우터 장비가 많을수록 네트워크의 규모도 커지고 이에 비례해 데이터가 갈수 있는 경로의 수도 함께 증가한다. 하지만 라우팅 장비는 많은 경로중에서 데이터의 손실 없이 가장 빠르고 안전하게 목적지까지 갈 수 있는 경로를 찾아야 하는데, 이러한 데이터 최적 경로 설정 방식을 Routing이라고 부른다.

### 정적 라우팅 프로토콜

네트워크 관리자가 데이터를 목적지까지 보낼 최적 경로를 직접 결정하고 경로상에 존재하는 라우터 장비의 라우팅 테이블을 수동으로 입력하여 고정적인 경로를 설정하는 방법

라우터 입장에서는 단순히 관리자가 수동으로 설정한 경로로만 데이터를 전송하면 되기 때문에, 라우터 장비의 중앙 처리 장치가 최적경로를 계산할 필요없고 그만큼 메모리 사용도 적어서 데이터를 빠르게 라우팅 할 수 있다.

하지만 이는 관리자가 직접 설정하는 것이기 때문에, 최적경로임을 보장하기 어렵고 관리자가 직접 각 라우터 장비의 라우팅 테이블을 수정해야 하기 때문에 변경이 쉽지 않다.

### 동적 라우팅 프로토콜

관리자의 개입 없이 라우터 장비 스스로 네트워크를 지나는 해당 경로를 계산해 최적 경로를 설정하고 직접 라우팅 테이블을 설정하는 방법이다.

라우터 장비들은 인접한 다른 라우터들과 연결 정보를 주기적으로 교환해서 각각의 연결 정보를 파악하고, 특정 기준에 따라 경로를 결정해 그 경로세 속해있는 라우터 장비의 라우팅 테이블을 갱신한다.

라우터가 라우팅 경로를 결정할 때 고려하는 특정 기준을 Metric이라고 부르고 이것은 여로 경로들 중 최적의 라우팅 경로를 결정하기 위해 경로의 우선순위를 매길 수 있게끔 수치로 환산한 하나의 변수이다.

동적 라우팅 프로토콜에는 대표적으로 라우팅 정보 프로토콜(Routing Information Protocol) 이라는 것이 있다. 

홉카운트 라는 매트릭으로 라우팅 경로가 결정되는데, 컴퓨터 A에서 컴퓨터 B로 데이터를 보낼 경우 총 2개의 라우팅 장비를 거쳐야한다면 이 경로의 홉카운트는 2가 된다.

홉 카운트가 높다는 것은 데이터가 지나가는 홉의 수, 즉 경로상 경유하는 라우터 장비가 많다는 뜻으로 그만큼 경로의 길이가 길어진다는 뜻이다.

RIP는 데이터가 목적지 까지 가는 경로중에서도 홉 카운트가 가장 작은 경로를 우선적으로 선택하는 프로토콜이다.


## 게이트웨이

